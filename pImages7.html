<!DOCTYPE HTML>
<!--
	David Styven Nieto Marin
	Ingenieria de Sistemas | @dsnietom
	Universidad Nacional de Colombia
-->
<html>
	<head>
		<title>Procesamiento de Imagenes | :: Computación Visual ::</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		
		<!-- Code-Prettify -->
		<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
		
		<!-- P5.js -->
		<script src="p5/p5.min.js"></script>
		<script src="p5/addons/p5.sound.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js"></script>
		<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/addons/p5.sound.min.js"></script> -->
		
		<!-- Bootstrap CSS 
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">-->
	
		<!-- Favicon -->
		<link rel="icon" href="images/favicon.png" sizes="32x32" type="image/png">

		
	</head>
	
	<body class="single is-preload">
	
	

		<!-- Wrapper -->
			<div id="wrapper">
			

				<!-- Header -->
					<header id="header">
						
						<nav class="links">
						
						<!-- Se crea un encabezado para insertar el html donde esta el menu-->
							<iframe src="menu.html" ></iframe>
							
						</nav>
						<nav class="main">
							<ul>
								<li class="search">
									<a class="fa-search" href="#search">Search</a>
									<form id="search" method="get" action="#">
										<input type="text" name="query" placeholder="Search" />
									</form>
								</li>
								<li class="menu">
									<a class="fa-bars" href="#menu">Menu</a>
								</li>
							</ul>
						</nav>
					</header>

				<!-- Menu -->
				<section id="menu">

					<!-- Search -->
						<section>
						<h1><a href="index.html" target="_parent">Visual Computing</a></h1>
							<form class="search" method="get" action="#">
								<input type="text" name="query" placeholder="Search" />
							</form>
						</section>

					<!-- Links -->
						<section>
							<ul class="links">
								<li>
									<a href="pImages1.html" target="_parent">
										<h3>GRAYSCALE IMAGE</h3>
										<p>RGB AVERAGE AND LUMA COEFFICIENT</p>
									</a>
								</li>
								<li>
									<a href="pImages2.html" target="_parent">
										<h3>CONVOLUTION MATRIX</h3>
										<p>BLURRING, SHARPENING, EMBOSSING, EDGE DETECTION, AND MORE</p>
									</a>
								</li>
								<li>
									<a href="pImages3.html" target="_parent">
										<h3>IMAGE TO ASCII</h3>
										<p>CHANGE PIXELS FOR CHARACTERS</p>
									</a>
								</li>
								<li>
									<a href="pImages4.html" target="_parent">
										<h3>IMAGE HISTOGRAM</h3>
										<p>GRAPHICAL REPRESENTATION OF THE TONAL DISTRIBUTION</p>
									</a>
								</li>
								<li>
									<a href="pImages5.html" target="_parent">
										<h3>VIDEO PROCESSING</h3>
										<p>GRAYSCALE, MASKS AND COMPLEMENTARY COLORS</p>
									</a>
								</li>
								<li>
									<a href="pImages6.html" target="_parent">
										<h3>VIDEO TO ASCII</h3>
										<p>CHANGE PIXELS FOR CHARACTERS</p>
									</a>
								</li>
								<li>
									<a href="pImages7.html" target="_parent">
										<h3>COMPUTATIONAL EFFICIENCY</h3>
										<p>VIDEO OPERATIONS MEASUREMENT</p>
									</a>
								</li>
							</ul>
						</section>

					<!-- Actions -->
						<section>
							<ul class="actions stacked">
								<li><a href="https://github.com/VisualComp/Procesamiento-imagenes/tree/master/Software" target="_blank" class="button large fit">Repository</a></li>
							</ul>
						</section>

				</section>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<article class="post">
								<header>
									<div class="title">
										<h2><a href="https://processing.org/reference/frameRate.html" target="_blank">Computational Efficiency</a></h2>
										<p>Video operations measurement</p>
									</div>
									<div class="meta">
										<time class="published" datetime="2015-11-01">May 28, 2020</time>
										<a href="https://dsnietom.github.io/myPageIngSoft/" target="_blank" class="author"><span class="name">David Nieto</span><img src="images/avatar.jpg" alt="dsnietom" /></a>
										
									</div>
								</header>
								<p>Una de las características más importantes en el procesamiento de videos es la frecuencia de fotogramas por segundo, el cerebro humano tiene la capacidad de procesar de 10 a 12 fotogramas por segundo; en caso de aumentar esa tasa. el cerebro lo percibe como movimiento, característica muy importante al momento de exponer una imagen.</p>
								
								<p>La siguiente implementación se encarga de medir la tasa de fotogramas por segundo, al realizar la razón entre la cantidad de fotogramas que se expusieron desde el tiempo 0 hasta la actualidad y la variables que se encarga de obtener la diferencia de tiempo transcurrido en el paso de los fotogramas, en la interacción se puede observar como esta taza decae cuando se aplica una máscara de convolución y aumenta cuando se aplica una escala de grises.</p>
								
								<hr />
								<h3>Comandos por teclado</h3>
								<div class="table-wrapper text-center">
									<table>
										<thead>
											<tr>
												<th>Tecla</th>
												<th>Operación</th>
												<th>Expresión</th>
												<th>Eficiencia Gerson</th>
												<th>Eficiencia Steven</th>
												<th>Eficiencia David</th>
												<th>Promedio</th>
												<th>Video resultante</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td><img src="images/keyboard/0.png" style="width:40px;vertical-align: middle"/></td>
												<td>Identidad</td>
												<td><img src="images/matrix/matrix0.png" style="width:100px;vertical-align: middle"/></td>
												<td>30,0</td>		
												<td>30,0</td>
												<td>30,0</td>
												<td>30,0</td>
												<td><img src="images/gray/vid0.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/1.png" style="width:40px;vertical-align: middle"/></td>
												<td>Acentuar los bordes<h5>(Máscara de Convolución)</h5></td>
												<td><img src="images/matrix/matrix1.png" style="width:100px;vertical-align: middle"/></td>
												<td>1,76</td>			
												<td>2,4</td>
												<td>1,05</td>
												<td>1,74</td>
												<td><img src="images/matrix/vid1.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/2.png" style="width:40px;vertical-align: middle"/></td>
												<td>Repujado<h5>(Máscara de Convolución)</h5></td>
												<td><img src="images/matrix/matrix2.png" style="width:100px;vertical-align: middle"/></td>
												<td>1,8</td>
												<td>2,3</td>
												<td>1,2</td>
												<td>1,77</td>
												<td><img src="images/matrix/vid2.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/3.png" style="width:40px;vertical-align: middle"/></td>
												<td>Detección de bordes<h5>(Máscara de Convolución)</h5></td>
												<td><img src="images/matrix/matrix3.png" style="width:100px;vertical-align: middle"/></td>
												<td>1,65</td>		
												<td>2,1</td>
												<td>1,16</td>
												<td>1,64</td>
												<td><img src="images/matrix/vid3.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>											
											<tr>
												<td><img src="images/keyboard/4.png" style="width:40px;vertical-align: middle"/></td>
												<td>Detección de bordes<h5>(Máscara de Convolución)</h5></td>
												<td><img src="images/matrix/matrix4.png" style="width:100px;vertical-align: middle"/></td>
												<td>1,7</td>		
												<td>2,1</td>
												<td>1,31</td>
												<td>1,70</td>
												<td><img src="images/matrix/vid4.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/5.png" style="width:40px;vertical-align: middle"/></td>
												<td>Detección de bordes<h5>(Máscara de Convolución)</h5></td>
												<td><img src="images/matrix/matrix5.png" style="width:100px;vertical-align: middle"/></td>
												<td>1,7</td>		
												<td>2,14</td>
												<td>1,4</td>
												<td>1,75</td>
												<td><img src="images/matrix/vid5.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/6.png" style="width:40px;vertical-align: middle"/></td>
												<td>Enfocar<h5>(Máscara de Convolución)</h5></td>
												<td><img src="images/matrix/matrix6.png" style="width:100px;vertical-align: middle"/></td>
												<td>1,73</td>		
												<td>2,03</td>
												<td>1,25</td>
												<td>1,67</td>
												<td><img src="images/matrix/vid6.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/7.png" style="width:40px;vertical-align: middle"/></td>
												<td>Desenfoque de cuadro<h5>(Máscara de Convolución)</h5></td>
												<td><img src="images/matrix/matrix7.png" style="width:150px;vertical-align: middle"/></td>
												<td>1,83</td> 		
												<td>2,49</td>
												<td>1,35</td>
												<td>1,89</td>
												<td><img src="images/matrix/vid7.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>		
											<tr>
												<td><img src="images/keyboard/a.png" style="width:40px;vertical-align: middle"/></td>
												<td>Media aritmética<h5>(Escala de Grises)</h5></td>
												<td><img src="images/gray/equation1.png" style="height:25px;;vertical-align: middle"/></td>
												<td>13,6</td>		
												<td>21,9</td>
												<td>11,8</td>
												<td>15,77</td>
												<td><img src="images/gray/vid1.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/b.png" style="width:40px;vertical-align: middle"/></td>
												<td>Componente más grande<h5>(Escala de Grises)</h5></td>
												<td><img src="images/gray/equation2.png" style="height:20px;;vertical-align: middle"/></td>
												<td>10,2</td>		
												<td>15,4</td>
												<td>8,6</td>
												<td>11,40</td>
												<td><img src="images/gray/vid2.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/c.png" style="width:40px;vertical-align: middle"/></td>
												<td>Rango medio<h5>(Escala de Grises)</h5></td>
												<td><img src="images/gray/equation3.png" style="height:25px;;vertical-align: middle"/></td>
												<td>8,5</td>		
												<td>10,6</td>
												<td>7,7</td>
												<td>8,93</td>
												<td><img src="images/gray/vid3.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/d.png" style="width:40px;vertical-align: middle"/></td>
												<td>Promedio ponderado Luma<h5>(Escala de Grises SDTV)</h5></td>
												<td><img src="images/gray/equation4.png" style="height:18px;;vertical-align: middle"/></td>
												<td>13,6</td>		
												<td>22,3</td>
												<td>11,2</td>
												<td>15,70</td>
												<td><img src="images/gray/vid4.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>
											<tr>
												<td><img src="images/keyboard/x.png" style="width:40px;vertical-align: middle"/></td>
												<td>Imagen Opuesta<h5>(Colores Complementarios)</h5></td>
												<td><strong><i><h2 style="display:inline">255 -</h2> <img src="images/gray/equation0.png" style="height:20px;;vertical-align: middle"/></i></strong></td>
												<td>17,3</td>		
												<td>27</td>
												<td>15,3</td>
												<td>19,87</td>
												<td><img src="images/complementary/vid1.gif" style="width:190px;vertical-align: middle"/></td>
											</tr>											
										</tbody>
									</table>
								</div>
								
								<div class="canvasp5js" >
									<div>
										<blockquote>Image of Lioness and her Lion cub (Panthera leo) are a species in the family Felidae. Source: <a href="https://66.media.tumblr.com/6779b609703c61130d8d59fcad857310/tumblr_n66mdcOUan1rpe379o2_500.gif" target="_blank">Giphy</a>.<p><strong>Lion Hello GIF - Find & Share on GIPHY</strong></p></blockquote>
										<div id="eficiency">
										
										</div>																										
									</div>
								
								</div>
								<p></p>
								<h4>p5*js Code</h4>
									<pre><code class="prettyprint">let value; // permite escoger que filtro se va a realizar
let matrixsize; // tamaño de la matriz
var matrix; // matriz     
let canvas_01;
let canvas_02;
var heightI = 500;  // altura del lienzo
var widthI = 500;   // anchura del lienzo

function preload() {
	img_01 = createCapture(VIDEO);
	img_02 = createCapture(VIDEO);
	img_01.hide();
	img_02.hide();
}

function setup() {    
	createCanvas(widthI*2+20, heightI);
	frameRate(30);
	background(255);

	canvas_01 = createGraphics(widthI, heightI);
	canvas_02 = createGraphics(widthI, heightI);
}

function draw(){
	drawCanvas_01();
	drawCanvas_02();   
	selectValue();

	image(canvas_01, 0, 0);
	image(canvas_02, widthI+10, 0);
}

function keyPressed(){
	matrixsize = 3;

	switch(key) {
		case 'a':
			value = 1;
			break;
		case 'b':
			value = 2;
			break;
		case 'c':
			value = 3;
			break;
		case 'd':
			value = 4;
			break;
		case 'e':
			value = 5;
			break;
		case 'f':
			value = 6;
			break;
		case 'g':
			value = 7;
			break;
		case 'x':
			value = 'c';
			break;
		case '0':   // Identidad
			value = 10;
			matrix = [ [  0,  0,  0 ],
					[  0,  1,  0 ],
					[  0,  0,  0 ] ]; 
			break;
		case '1':   // Enfocar. Acentúa los bordes
			value = 11;
			matrix = [ [ -1, -1, -1 ],
					[ -1,  9, -1 ],
					[ -1, -1, -1 ] ]; 
			break;
		case '2':   // Repujado
			matrix = [ [ -2, -1,  0 ],
					[ -1,  1,  1 ],
					[  0,  1,  2 ] ]; 
			value = 12;
			break;
		case '3':   // Detección de bordes
			matrix = [ [  1,  0, -1 ],
					[  0,  0,  0 ],
					[ -1,  0,  1 ] ]; 
			value = 13;
			break;
		case '4':
			matrix = [ [  0,  1,  0 ],
					[  1, -4,  1 ],
					[  0,  1,  0 ] ]; 
			value = 14;
			break;
		case '5':
			matrix = [ [ -1, -1, -1 ],
					[ -1,  8, -1 ],
					[ -1, -1, -1 ] ];
			value = 15;
			break;
		case '6':   // Enfocar
			matrix = [ [  0, -1,  0 ],
					[ -1,  5, -1 ],
					[  0, -1,  0 ] ];
			value = 16;
			break;
		case '7':   // Desenfoque de cuadro (normalizado)
			matrix = [ [ 1/9, 1/9, 1/9 ],
					[ 1/9, 1/9, 1/9 ],
					[ 1/9, 1/9, 1/9 ] ]; 
			value = 17;
			break;
		case '8':   // Desenfoque gaussiano 5 × 5 (aproximación)
			matrixsize = 5;
			matrix = [ [ 1/256,  4/256,  6/256,  4/256, 1/256 ],
					[ 4/256, 16/256, 24/256, 16/256, 4/256 ],
					[ 6/256, 24/256, 36/256, 24/256, 6/256 ],
					[ 4/256, 16/256, 24/256, 16/256, 4/256 ],
					[ 1/256,  4/256,  6/256,  4/256, 1/256 ] ];
			value = 18;
			break;
		case '9':   // Máscara de desenfoque 5 × 5 (sin máscara de imagen)
			matrixsize = 5;
			matrix = [ [ -1/256,  -4/256,  -6/256,  -4/256, -1/256 ],
					[ -4/256, -16/256, -24/256, -16/256, -4/256 ],
					[ -6/256, -24/256, 476/256, -24/256, -6/256 ],
					[ -4/256, -16/256, -24/256, -16/256, -4/256 ],
					[ -1/256,  -4/256,  -6/256,  -4/256, -1/256 ] ];
			value = 19;
			break;
		default:
			break;
	}
}

// Funciones propias del desarrollo
const drawCanvas_01 = ()=>{ // pone el primer video en el lienzo 1
	canvas_01.image(img_01, 0, 0);
	canvas_01.textSize(40);

		//  imprime los frames por segundo 
	canvas_01.text( frameRate().toFixed(2) + " F/S" , 20, 400);
};

const drawCanvas_02 = ()=>{ // pone el segundo video en el lienzo 2
	canvas_02.image(img_02, 0, 0);
	canvas_02.textSize(40);

		//  imprime los frames por segundo 
	canvas_02.text( frameRate().toFixed(2) + " F/S" , 20, 400);
};

const selectValue = ()=>{
		//selecciona el filtro a utilizar dependiendo del valor que tenga value
	if( 0 &lt value && value &lt 10 ) {
		filtrosBlancoNegro(value);
	} else if(value === 'c') {
		complementary();
	} else if(value > 10) {
		convolutions();
	}
}

// Funciones para aplicar filtros
const filtrosBlancoNegro = (gray)=>{
	let lightness = 210;
	img_02.loadPixels();

	for (let y = 0; y &lt img_02.height; y++) {
		for (let x = 0; x &lt img_02.width; x++){ 
			let index = (x+y*img_02.width)*4; // Posicion del pixel
			
			let r=img_02.pixels[index+0]; // Componente Red
			let g=img_02.pixels[index+1]; // Componente Green
			let b=img_02.pixels[index+2]; // Componente Blue
			let a=img_02.pixels[index+3]; // Componente Alpha
			
			if (gray===1){
				let I=(r+g+b)/3; // Promedio de los tres componentes
				lightness = I;
			} else if (gray===2){
				let V= max(r,g,b); // Componente mas grande de un color
				lightness = V;
			} else if (gray===3){
				let L=(max(r,g,b)+min(r,g,b))/2; // Promedio entre el componente mas grande y el mas pequeño
				lightness = L;
			} else if (gray===4){ // Promedio ponderado de RGB con corrección gamma (Luma)
				let Y601= 0.2989*r + 0.5870*g + 0.1140*b; // SDTV
				lightness = Y601;
			} else if (gray===5){ 
				let Y240= 0.212*r + 0.701*g + 0.087*b; // Adobe
				lightness = Y240;
			} else if (gray===6){ 
				let Y709= 0.2126*r + 0.7152*g + 0.0722*b; // HDTV
				lightness = Y709;
			} else if (gray===7){ 
				let Y2020= 0.2627*r + 0.6780*g + 0.0593*b; // UHDTV,HDR
				lightness = Y2020;
			} 

			img_02.pixels[index+0]=lightness;
			img_02.pixels[index+1]=lightness;
			img_02.pixels[index+2]=lightness;
			img_02.pixels[index+3]=a;
			
			if (gray===0){ // Imagen original
				pixels[index+0]=r;
				pixels[index+1]=g;
				pixels[index+2]=b;
				pixels[index+3]=a;
			}
		}
	}
	img_02.updatePixels();
}

const complementary = ()=>{
	img_02.loadPixels();

	for(var y = 0 ; y &lt img_02.height; y++) {
		for(var x = 0; x &lt img_02.width; x++) {
			let index = (x + y * img_02.width) * 4;
			img_02.pixels[index + 0] = 255 - img_02.pixels[index + 0];
			img_02.pixels[index + 1] = 255 - img_02.pixels[index + 1];
			img_02.pixels[index + 2] = 255 - img_02.pixels[index + 2];
		}
	}
	img_02.updatePixels();
}

const convolutions = ()=>{    
	img_02.loadPixels();

	for (let x = 0; x &lt img_02.width; x++) {
		for (let y = 0; y &lt img_02.height; y++ ) { 
			let c = convolutionAux(x, y, matrix, matrixsize, img_02);
			let loc = (x + y*img_02.width)*4;
			img_02.pixels[loc] = red(c);
			img_02.pixels[loc+1] = green(c);
			img_02.pixels[loc+2] = blue(c);
			img_02.pixels[loc+3] = alpha(c);
		}
	}    
	img_02.updatePixels();
}

const convolutionAux = (x, y, matrix, matrixsize, img)=>{
	var rtotal = 0;
	var gtotal = 0
	var btotal = 0;
	var atotal = 0;

	for (let i = 0; i &lt matrixsize; i++){
		for (let j= 0; j &lt matrixsize; j++){
			var xloc = x+i;
			var yloc = y+j;
			var loc = (xloc + img.width*yloc)*4;

			loc = constrain(loc,0,img.pixels.length-1);
			rtotal += ((img.pixels[loc]) * matrix[i][j]);
			gtotal += ((img.pixels[loc+1]) * matrix[i][j]);
			btotal += ((img.pixels[loc+2]) * matrix[i][j]);
			atotal += ((img.pixels[loc+3]) * matrix[i][j]);
		}
	}
	// Restringe el valor de RGB
	rtotal = constrain(rtotal, 0, 255);
	gtotal = constrain(gtotal, 0, 255);
	btotal = constrain(btotal, 0, 255);
	atotal = constrain(atotal, 0, 255);
	// Retorna el color resultante
	return color(rtotal, gtotal, btotal);
}</code></pre>								
								<p></p>
								
								<!-- Pagination -->
							<ul class="actions pagination">
								<li><a href="pImages6.html" target="_parent" class="button large previous">Previous Page</a></li>
								<li><a href="#" target="_parent" class="disabled button large next">Next Page</a></li>
							</ul>
							
							<!-- Footer 
								<footer>
									<ul class="stats">
										<li><a href="#">General</a></li>
										<li><a href="#" class="icon solid fa-heart">28</a></li>
										<li><a href="#" class="icon solid fa-comment">128</a></li>
									</ul>
								</footer>-->
								
							</article>

					</div>

				<!-- Footer -->
					<section id="footer">
					<!-- Se crea un iframe para insertar el html donde esta el pie de pagina-->
						<footer>
							<iframe id="iframepie" src="footer.html"></iframe>
						</footer>
						
					</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			
		<!-- Ejemplos P5.js -->
			<script src="p5/js/images/eficiency.js"></script>

			
		<!-- Optional JavaScript -->
		<!-- jQuery first, then Popper.js, then Bootstrap JS -->
			<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
			<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
			<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

	</body>
</html>